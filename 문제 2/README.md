# 문제 2

아래의 요구 사항에 맞는 테이블을 설계하여 ERD를 작성해 주세요

기초 테이블 정의를 바탕으로 작성하며,
유저스토리에 따라 테이블의 수정 및 추가를 하실 수 있습니다

## 기초 테이블 정의

- **user** table은 이름(name), 이메일(email), 패스워드(password), 가입일(created_at)을 가지고 있다.
- **post** table은 글제목(title), 본문(content), 글 작성일(created_at), 작성자(user_id)를 가지고 있다
- **tag** table은 태그명(name), 태그 생성일(created_at)을 가지고있다

### 유저 스토리

- user는 post를 작성할수 있다
- user는 post는 복수의 tag를 추가 할수있다
- user는 탈퇴처리 처리가 가능해야한다
- user가 탈퇴 되더라도, post는 삭제되서는 안된다
- tag로 post를 검색할수 있어야 한다

---

### 💡 추가질문 - 성능을 개선하기 위한 아이디어를 제시해 주세요

---

### ↘️ ANSWER 1. ERD

```
+-----------------------------------+          +-----------------------------------+
|              User                 |          |              Tag                  |
+-----------------------------------+          +-----------------------------------+
| id (PK)                           |          | tag_id (PK)                       |
| name                              |          | name                              |
| email                             |          | created_at                        |
| password                          |          +-----------------------------------+
| created_at                        |                             |
| alive                             |                             |
+-----------------------------------+                             | (M:N)
                 |                                                |
                 | (1:N)                                          |
                 V                                                V
+-----------------------------------+          +-----------------------------------+
|              Post                 |          |            Post_Tag               |
+-----------------------------------+          +-----------------------------------+
| post_id (PK)                      |   (M:N)  | post_id (PK, FK -> Post.post_id)  |
| title                             | -------> | tag_id (PK, FK -> Tag.tag_id)     |
| content                           |          +-----------------------------------+
| created_at                        |
| user_id (FK -> User.id)           |
+-----------------------------------+

```

### ↘️ ANSWER 2. 추가 질문 - 성능을 개선하기 위한 아이디어

#### ■ 인덱스 최적화

- 태그로 게시글을 검색할 경우, 다대다 관계를 관리하기 위한 별도의 조인 테이블을 사용해서 post_id와 tag_id의 복합 인덱스를 적용 (ERD 적용)
- 작성자와 글 작성일에 인덱스를 추가해서 특정 사용자가 작성한 글 검색이나 최근 게시글에 조회 성능 향상

#### ■ Soft Delete

- 사용자가 탈퇴하더라도 게시글은 삭제되지 않아야 하므로 user 테이블에서 실제 DELETE 수행 대신 alive 컬럼을 추가하여 탈퇴 여부를 관리하여 관련 게시글 데이터의 무결성을 유지하면서도 불필요한 JOIN이나 데이터 복구 작업 없이 성능 저하를 방지 (ERD 적용)

#### ■ 데이터 캐싱

- 자주 조회되는 태그 검색결과나 인기글 같은 경우 Redis와 같은 인메모리 DB를 도입하여 이곳에 캐싱해 DB 부하 방지 및 응답 속도 향상 가능. 단, 여러가지 캐시 전략 중 상황을 고려해 알맞은 것을 사용해야 합니다.

#### ■ Replication

- Master DB는 쓰기 작업을 담당하고, Slave DB는 읽기 작업을 처리하도록 구성하면 특정 DB에 과도한 부하가 걸리지 않고 트래픽 양에 따라 Slave DB를 병렬로 둘 수도 있지만 데이터 정합성을 100%보장한다고 할 수는 없기에 금융 등의 민감한 정보의 경우 사용할 수 없습니다.
